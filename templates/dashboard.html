{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}

<h1>Bienvenue {{ username }}</h1>

<div class="grid" style="margin-top: 1.5rem;">

    <!-- Carte statistiques -->
    <div class="card">
        <h2>Statistiques</h2>
        <div style="margin-top: 1rem; line-height: 1.7;">
            <p><strong>Clients :</strong> {{ stats.clients_total }}</p>
            <p><strong>Rendez-vous à venir :</strong> {{ stats.rdv_cette_semaine }}</p>
            <p><strong>Rendez-vous totaux :</strong> {{ stats.opportunites_ouvertes }}</p>
            <p><strong>Documents :</strong> {{ stats.documents_partages }}</p>
        </div>
    </div>

    <!-- Carte RDV -->
    <div class="card">
        <h2>Rendez-vous à venir</h2>
        {% if upcoming_appointments %}
            <ul style="margin-top: 1rem;">
                {% for rdv in upcoming_appointments %}
                <li style="margin-bottom: .5rem;">
                    <strong>{{ rdv.date.strftime("%d/%m/%Y") }}</strong> -
                    {{ rdv.time.strftime("%H:%M") }} :
                    {{ rdv.title }} ({{ rdv.client_name }})
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Aucun rendez-vous.</p>
        {% endif %}
    </div>

    <!-- Carte documents -->
    <div class="card">
        <h2>Derniers documents</h2>
        {% if latest_docs %}
            <ul style="margin-top: 1rem;">
                {% for doc in latest_docs %}
                <li style="margin-bottom: 0.5rem;">
                    {{ doc.original_name }}  
                    <span style="color: #777;">
                        ({{ doc.uploaded_at.strftime("%d/%m/%Y %H:%M") }})
                    </span>
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Aucun document récent.</p>
        {% endif %}
    </div>

</div>

{% endblock %}
